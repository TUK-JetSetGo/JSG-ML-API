# VO 명세서

## 1. VO 요구사항

### 1.1 Coordinate VO

**목적:**  
- 지리적 좌표 정보를 표현하고, 두 좌표 간의 정확한 지오데식 거리를 계산하는 기능을 제공합니다.

**주요 속성:**  
- **latitude (float):** 위도 (기본값: 0.0)  
- **longitude (float):** 경도 (기본값: 0.0)

**주요 기능:**  
- **distance_to(other: Coordinate) -> float:**  
  - Vincenty 공식(정밀 계산) 또는 하버사인 공식을 사용하여 두 좌표 간의 거리를 km 단위로 계산합니다.
- **is_near(other: Coordinate, threshold_km: float = 1.0) -> bool:**  
  - 두 좌표 간의 거리가 지정된 임계값(기본 1km) 이내에 있는지 판단합니다.
- **__str__() -> str:**  
  - 위도와 경도를 소수점 6자리까지 표시하는 문자열을 반환합니다.

---

### 1.2 TimeWindow VO

**목적:**  
- 특정 시간 범위를 나타내며, 시간 간격의 지속 시간 계산, 특정 시간의 포함 여부 판단, 그리고 두 시간 범위 간의 겹침 여부를 검증하는 기능을 제공합니다.

**주요 속성:**  
- **start_time (time):** 범위의 시작 시간  
- **end_time (time):** 범위의 종료 시간

**주요 기능:**  
- **duration_hours() -> float:**  
  - 시작 시간과 종료 시간 사이의 지속 시간을 시간 단위로 계산하여 반환합니다.  
  - 종료 시간이 시작 시간보다 이른 경우(자정 넘어가는 경우)를 올바르게 처리합니다.
- **contains(check_time: time) -> bool:**  
  - 주어진 시간이 해당 시간 범위 내에 포함되는지 확인합니다.  
  - 자정이 넘어가는 시간 범위(예: 22:00 ~ 02:00)도 정확히 처리합니다.
- **overlaps(other: TimeWindow) -> bool:**  
  - 다른 TimeWindow와 겹치는지 여부를 판단합니다.
- **__str__() -> str:**  
  - "HH:MM - HH:MM" 형식의 문자열로 시간 범위를 표현합니다.

---

### 1.3 TravelDuration VO

**목적:**  
- 이동 시간과 이동 거리를 기반으로 평균 속도 및 이동 시간을 분 단위로 환산한 값을 제공합니다.

**주요 속성:**  
- **hours (float):** 이동 시간 (시간 단위)  
- **distance_km (float):** 이동 거리 (킬로미터 단위)  
- **transport_mode (str):** 이동에 사용한 교통 수단 ("car", "public_transport", "walk")

**주요 기능:**  
- **minutes (property) -> int:**  
  - `hours` 값을 분 단위로 환산하여 반환합니다.
- **speed_kmh (property) -> float:**  
  - 이동 거리를 이동 시간으로 나누어 평균 속도를 km/h 단위로 계산합니다.  
  - `hours`가 0인 경우 0을 반환합니다.
- **__str__() -> str:**  
  - 이동 시간, 이동 거리 및 교통 수단 정보를 포함한 사용자 친화적인 문자열을 반환합니다.  
  - 1시간 이상이면 "X시간 Y분 (Z.Zkm, transport_mode)" 형식, 1시간 미만이면 "Y분 (Z.Zkm, transport_mode)" 형식으로 표현합니다.

---

## 2. 일반 요구사항

- **불변성:**  
  모든 VO는 `@dataclass(frozen=True)`로 구현되어 생성 후 내부 상태 변경이 불가능합니다. 이를 통해 데이터 무결성을 보장합니다.

- **유효성 검사 및 타입 변환:**  
  각 VO는 `__post_init__` 메서드를 통해 입력 값의 타입을 검증하고, 필요한 경우(예: 문자열을 숫자나 시간 객체로 변환) 적절한 변환 및 예외 처리를 수행합니다.

- **문자열 표현 및 동등성:**  
  - 각 VO는 `__str__` 및 `__repr__` 메서드를 구현하여, 디버깅 및 로그 기록, 사용자 메시지 출력 시 유용하게 활용됩니다.
  - 값 객체는 동일한 값을 갖는 경우 동일한 객체로 인식됩니다.

- **재사용성 및 확장성:**  
  VO는 여러 도메인 엔티티에서 공통으로 사용되도록 설계되어, 중복 코드 감소 및 유지보수성을 향상시킵니다.  
  향후 도메인 로직 확장 시, VO의 인터페이스와 기능은 변경 없이 확장될 수 있도록 고려되어야 합니다.

- **테스트 전략:**  
  각 VO에 대해 단위 테스트를 작성하여, 핵심 기능(예: 거리 계산, 시간 범위 계산, 속도 및 분 환산 등)이 올바르게 동작하는지 검증합니다.  
  pytest 등의 테스트 도구를 활용하여 자동화된 테스트를 수행하고, CI/CD 파이프라인에 포함시켜 안정성을 확보합니다.
